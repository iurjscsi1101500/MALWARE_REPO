import hashlib,sys
user_hash_dict = {}
GREEN = '\033[92m'
YELLOW = '\033[93m'
RED = '\033[91m'
if len(sys.argv) == 3:
    pass
else:
    print(RED + "Syntax:python3.11 main.py <password_list> <usernames_list>")
with open(f"{sys.argv[1]}",'r') as f:
    common_passwords = f.read().splitlines()
with open(f"{sys.argv[2]}",'r') as f:
    text = f.read().splitlines()
    for user_hash in text:
        username = user_hash.split(":")[0]
        hash = user_hash.split(":")[1]
        user_hash_dict[username] = hash

for password in common_passwords:
    hashed_password = hashlib.sha256(password.encode('utf-8')).hexdigest()
    for username,hash in user_hash_dict.items():
        if hashed_password == hash:
            print(GREEN + f"Password CRACKED!!!{username}:{password}\n")