import smtplib
import threading,os
from time import sleep
os.system("clear")
class bcolors:
    GREEN = '\033[92m'
    YELLOW = '\033[93m'
    RED = '\033[91m'

print(bcolors.GREEN + '''   ____                    ____   ___  __  __ ____       ____    ___  
  / ___| ___ _ __ ___  ___| __ ) / _ \|  \/  | __ )_   _|___ \  / _ \ 
 | |  _ / _ \ '_ ` _ \/ __|  _ \| | | | |\/| |  _ \ \ / / __) || | | |
 | |_| |  __/ | | | | \__ \ |_) | |_| | |  | | |_) \ V / / __/ | |_| |
  \____|\___|_| |_| |_|___/____/ \___/|_|  |_|____/ \_/ |_____(_)___/ \n\n''')
sleep(1)
print("CopyRight Atharva,Tiwari 2023\n\n")
sleep(1)
try:
    sender = str(input(bcolors.YELLOW + "Enter Senders Email: "))
    password = str(input(bcolors.YELLOW + "Enter Senders Passwords: "))
    receiver = str(input(bcolors.YELLOW + "Enter Receivers Email: "))
    subject = str(input(bcolors.YELLOW + "Enter Subject: "))
    body = str(input(bcolors.YELLOW + "Enter body: "))
    nums = int(input(bcolors.YELLOW + "Enter the numbers of thread(mean more mail recommeded 1): "))
    message = f"""From: {sender}
    To: {receiver}
    Subject: {subject}\n
    {body}
    """

    server = smtplib.SMTP("smtp.gmail.com", 587)
    server.starttls()
    def send_email():
        server.sendmail(sender,receiver,message)
        print(bcolors.GREEN + "Mail Send")
    try:
        server.login(sender,password)
        print(bcolors.GREEN + "Logged in...")
        threads = []
        for i in range(nums):
            t = threading.Thread(target=send_email)
            t.daemon =  True
            threads.append(t)

        for i in range(nums):
            threads[i].start()
        for i in range(nums):
            threads[i].join()

    except smtplib.SMTPAuthenticationError:
        print(bcolors.RED + "ERROR: Unable to Sign in")

except KeyboardInterrupt:
    print("\n" + bcolors.RED + "Ctrl + C Detcted Exiting...")

except Exception as e:
    print("\n" + bcolors.RED + "ERROR: unexpection error")